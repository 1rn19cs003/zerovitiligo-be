generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Doctor {
  id             String           @id @default(uuid())
  name           String
  email          String           @unique
  password       String
  role           DoctorRole       @default(ASSISTANT)
  createdAt      DateTime         @default(now())
  mobile         String?
  Appointment    Appointment[]
  patients       Patient[]
  medicineDiaries MedicineDiary[]
}

model Patient {
  id               String           @id @default(uuid())
  name             String
  age              Int
  bodyWeight       Float?
  address          String?
  vitiligoDuration String?
  currentMedicine  String?
  vaccineDoses     String?
  familyHistory    String?
  status           Status           @default(NEW_REGISTRATION)
  doctorId         String?
  assistantId      String?
  createdAt        DateTime         @default(now())
  diseaseDetails   String?
  hasDisease       String?
  patientId        String           @unique
  state            String?
  mobile           String           @unique
  Appointment      Appointment[]
  images           Image[]
  medicineDiaries  MedicineDiary[]
  doctor           Doctor?          @relation(fields: [doctorId], references: [id])
}

model Image {
  id         String   @id @default(uuid())
  url        String
  patientId  String
  uploadedAt DateTime @default(now())
  patient    Patient  @relation(fields: [patientId], references: [id])
}

model Appointment {
  id              String            @id @default(uuid())
  doctorId        String
  patientId       String
  appointmentDate DateTime
  startTime       DateTime
  endTime         DateTime?
  reason          String?
  status          AppointmentStatus @default(SCHEDULED)
  notes           String?
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  medication      String?
  doctor          Doctor            @relation(fields: [doctorId], references: [id])
  patient         Patient           @relation(fields: [patientId], references: [id])
}

model MedicineDiary {
  id           String   @id @default(uuid())
  date         DateTime
  medicineCode String
  durationDays Int
  price        Float
  comments     String?
  patientId    String
  createdBy    String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  patient      Patient  @relation(fields: [patientId], references: [id])
  doctor       Doctor   @relation(fields: [createdBy], references: [id])
}

model YoutubeVideo {
  id        String   @id @default(uuid())
  url       String   @unique
  shorts    String?
  title     String?
  author    String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model VisitorCounter {
  id        String   @id @default(uuid())
  count     Int      @default(0)
  updatedAt DateTime @updatedAt
}

enum AppointmentStatus {
  SCHEDULED
  COMPLETED
  CANCELLED
  MISSED
}

enum DoctorRole {
  ADMIN
  ASSISTANT
}

enum Status {
  NEW_REGISTRATION
  UNDER_TREATMENT
  TREATMENT_COMPLETED
  PAUSE
  FOLLOW_UP
  BLOCKED
}
